
<form class="visitorForm" [formGroup]="addvisitorForm" (ngSubmit)="onSubmit()">
  <p-toast />
  <div class="row mb-3">
      <div class="col">
          <label class="inputLabel">Name<span class="astrik">*</span></label>
          <p-floatLabel>
            <input  class="form-control smallInput p-inputtext" formControlName="name" id="name"
             placeholder="" required/>
            <label for="name">Enter the Name</label>
            <div *ngIf="addvisitorForm.get('name')?.hasError('required')&& addvisitorForm.get('name')?.touched" class="astrik">
              *Name is required.
            </div>
          </p-floatLabel>
      </div>
      <div class="col">
          <label class="inputLabel">Phone Number<span class="astrik">*</span></label>
          <p-floatLabel>             
              <input type="text"  class="form-control smallInput p-inputtext" id="phoneNumber" name="phoneNumber" required
              formControlName="phoneNumber" placeholder="">
              <label for="phoneNumber">Enter the Phone Number</label>
              <div *ngIf="addvisitorForm.get('phoneNumber')?.hasError('required')&& addvisitorForm.get('phoneNumber')?.touched" class="astrik">
                *Phone Number is required.
              </div>
            </p-floatLabel>
      </div>
  </div>
  <div class="row mb-3">
      <div class="col">
          <label class="inputLabel">Whom to Meet<span class="astrik">*</span></label>
          <div class="form-floating largeInput">
            <p-floatLabel>
              <p-autoComplete 
  class="largeInput"
 name="personInContact"
  formControlName="personInContact"
  [dropdown]="true" 
  [suggestions]="filteredContacts" 
  (completeMethod)="filterContact($event)" 
  inputId="autocomplete-input"
  placeholder=" "
  required></p-autoComplete>

              <label for="autocomplete-input">Enter the name of the host</label>
          </p-floatLabel>  
          <div *ngIf="addvisitorForm.get('personInContact')?.hasError('required')&& addvisitorForm.get('personInContact')?.touched"class="astrik">
            *Name of the host is required.
          </div> 
          </div>
      </div>
     
  </div>
  <div class="row mb-3">
      <div class="col">
          <label class="inputLabel">Purpose of Visit<span class="astrik">*</span></label><br>    
          <p-floatLabel>      
          <p-autoComplete class="largeInput"          
          [dropdown]="true"
          [suggestions]="filteredPurposes"
          (completeMethod)="filterPurpose($event)"
          field="purposeName"
          name="purposeofvisit"
          inputId="purpose-autocomplete-input"
          formControlName="purposeofvisit"
          (keyup)="onKeyUpHandlerPurpose($event)"
          (onSelect)="onPurposeChange($event)"
         >
        </p-autoComplete>
        <label for="autocomplete-input">Enter the name of the Purpose of Visit</label>
      </p-floatLabel> <!-- Placeholder added to trigger floating label -->
        <div *ngIf="addvisitorForm.get('purposeofvisitId')?.hasError('required')&& addvisitorForm.get('purposeofvisitId')?.touched" class="astrik">
          *Name of the purpose is required.
        </div> 
      </div>
  </div>

  
    <div formArrayName="items">
      <div *ngFor="let item of items.controls; let i = index" [formGroupName]="i">
        <div class="row mb-3">
          <div class="col">
            <label class="inputLabel">Device Carried<span class="astrik">*</span></label>
          <p-floatLabel> 
            <p-autoComplete class="customInput"                            
                            (onSelect)="onItemChange($event, i)"
                            (keyup)="onKeyUpHandlerDevice($event, i)"
                            [dropdown]="true"
                            [suggestions]="filteredDevice"
                            (completeMethod)="filterItem($event)"
                            field="deviceName"
                            name="Device"
                            inputId="autocomplete-input"
                            formControlName="Device"
                            required>
            </p-autoComplete>
            <label for="autocomplete-input">Enter the Device Carried</label>
          </p-floatLabel> 
            <div *ngIf="item.get('Device')?.hasError('required') && item.get('Device')?.touched" class="astrik">
              *Device is required.
            </div>
          </div>
         <!-- <div>
          <button (click)="checkPermission()">checkPermission</button>
         </div> -->
         <!-- <div *ngIf="camData">
          <webcam [trigger]="$trigger" (imageCapture)="capture($event)"></webcam>
          <button (click)="captureImage()">show</button>
         </div>
         <div>
          <div *ngIf="capturedImage">
            <img [src]="capturedImage">
          </div>
         </div> -->
       
          <div class="col d-flex align-items-end">
           
              <i class="material-icons astrik plus" (click)="addItem()">add_circle</i>
            
          </div>
          
        </div>
  
        <div class="row mb-3" *ngIf="items.at(i).value.showItemOtherInput">
          <div class="">
            <label class="inputLabelSerial" for="serialNumber">Enter Serial Number {{ items.at(i).value.deviceName }}</label>
            
            <input type="text" class="form-control mediumInput p-inputtext" name="DeviceSerialnumber" required formControlName="DeviceSerialnumber" id="serialNumber" placeholder="">
            <div *ngIf="item.get('DeviceSerialnumber')?.hasError('required') && item.get('DeviceSerialnumber')?.touched" class="astrik">
              *Serial Number is required.
            </div>
          </div>
        </div>
  
      
      </div>
    </div>
  
  <div class="row mb-3">
      <div class="form-check">
          <input class="form-check-input"  formControlName="policy" type="checkbox" id="privacyPolicy" required>
          <label class="form-check-label" for="privacyPolicy">
              I confirm, I have read and agree to Experion Technologies'<a href="#"> Privacy Policy </a>and consent to sharing my information.
          </label>
          <div *ngIf="addvisitorForm.get('policy')?.hasError('required') && addvisitorForm.get('policy')?.touched" class="astrik">
            *Please indicate your confirmation..
          </div>
      </div>
  </div>
  <div class="row mb-3">
      <!-- <div class="col">
        <button (click)="checkPermission()" class=" button3" type="button">
         Permission
      </button>
        <div *ngIf="camData">
          <webcam [trigger]="$trigger" (imageCapture)="capture($event)"></webcam>
          <button class=" button3"(click)="captureImage()" type="button">
              <i class="material-icons  camera">photo_camera</i>
              Take Photo<span class="astrik">*</span>
          </button>
        </div>
        <div>
         <div *ngIf="capturedImage">
           <img [src]="capturedImage" width="500px" height="500px">
         </div>
        </div>
      </div> -->
      <div class="col">
        <button class=" button3"(click)="openDialog()" type="button">
          <i class="material-icons  camera">photo_camera</i>
           Photo<span class="astrik-white">*</span>
      </button>
       
      <div *ngIf="capturedImage">
        <img [src]="capturedImage.imageAsDataUrl">
      </div>
      </div>
      <div class="col">
        
          <button class=" button3" type="submit">
              Submit
          </button>
      </div>
     
  </div>
  
</form>

<!-- [ngClass]="{ 'plusBtnHide': !isItemEntered(i) }" -->